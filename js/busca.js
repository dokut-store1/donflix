const tablas=["peliculas","peliculas2","peliculas3","peliculas4","peliculas5","peliculas6"];function normalizarTexto(texto){return texto.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase()}
function mostrarBuscador(){document.getElementById('buscador').style.display='block';document.getElementById('buscador').focus();document.getElementById('resultados').style.display='block'}
function cerrarBuscador(){document.getElementById('buscador').style.display='none';document.getElementById('resultados').style.display='none'}
let debounceTimeout;function buscarPeliculas(){let query=normalizarTexto(document.getElementById('buscador').value);let resultados=document.getElementById('resultados');resultados.innerHTML="";if(query.length===0)return;let peliculasEncontradas=[];let maxResultados=5;tablas.forEach(tabla=>{db.ref(tabla).once("value",snapshot=>{snapshot.forEach(child=>{let pelicula=child.val();let tituloNormalizado=normalizarTexto(pelicula.titulo);if(tituloNormalizado.includes(query)){if(peliculasEncontradas.length<maxResultados){peliculasEncontradas.push(pelicula.titulo);let li=document.createElement("li");li.style.listStyleType="none";li.style.margin="10px 0";li.style.padding="10px";li.style.cursor="pointer";li.textContent=pelicula.titulo;li.onclick=()=>redirigirResultados(pelicula.titulo);resultados.appendChild(li)}}})})})}
function debouncedBuscarPeliculas(){clearTimeout(debounceTimeout);debounceTimeout=setTimeout(buscarPeliculas,500)}
document.getElementById('buscador').addEventListener('input',debouncedBuscarPeliculas);function redirigirResultados(titulo){window.location.href=`resultados.html?busqueda=${encodeURIComponent(titulo)}`}
window.addEventListener('click',function(event){if(!document.getElementById('buscador').contains(event.target)&&!document.querySelector('.lupa').contains(event.target)){cerrarBuscador()}});function activarBusquedaMovil(){document.getElementById('buscador').style.width='100%';document.getElementById('buscador').style.fontSize='18px'}
if(window.innerWidth<=768){document.querySelector('.celular').style.display='inline-block'}
function verificarEnter(event){if(event.key==="Enter"){let query=normalizarTexto(document.getElementById('buscador').value);if(query.length>0){redirigirResultados(query)}}}